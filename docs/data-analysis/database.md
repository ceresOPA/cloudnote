# 数据库面试/复试

## 一、事务

### 1. 什么是事务？

- 对数据库的一组操作？

### 2. 事务的ACID性是什么？

- 原子性(automatic)：操作不可分隔，要么全部commit(提交)，要么全部rollback(回滚)
- 一致性(consistency)：事务查询得到的结果都是相同的
- 隔离性(isolated)：每个事务的操作对于其他事务都是不可见的
- 持久性(duration)：事务的操作是永久性的，即使数据库崩溃，也能够恢复



?> 补充：事务的四个特性并不是相互独立的，当事务是单道顺序执行的时候，就满足了隔离性，若此时事务能够满足原子性，那么事务就一定是满足一致性的。也就是说，若事务是并发进行的，在没有办法保证隔离性的条件下，不一致性的问题也将出现。

### 3. 并发带来的不一致性问题

- 同时修改，A事务修改某记录后，B事务同时也修改了该记录，导致前一个修改被覆盖。
- 脏数据的读取，原本要先执行A事务去修改某数据，然后B事务再读取，结果B事务先执行，导致读取了旧的数据



## 二、封锁

### 1. 封锁的粒度

- 简而言之，就是封锁粒度越小，那么事务的并发性就越差，系统的开销就越大，但数据的安全性更高；反之，若封锁的粒度越大，那么事务的并发性就越好，系统开销小，但就有更大的可能出现不一致性等数据异常的问题。

### 2. X锁与S锁

- X锁，即排它锁，当使用X锁后，该事务可以进行修改与读取，但直到该锁释放前，其他事务不能在增加任何锁
- S锁，即共享锁，当使用S锁后，该事务只能够进行读取操作，而且其他事务也可以继续增加S锁

### 3. 意向锁

- 在X锁和S锁的基础上，增加了Xi锁、Si锁，要求只有在使用了Xi锁后，才能够使用X锁（ps：也许这样吧，也有可能记错了👻



## 三、ER图

- 实体：用矩形表示，entity
- 属性：用圆形表示，用直线连接到对应实体，表示实体的属性
- 关系：用菱形表示，连接两个实体，表示两实体间是一对一、一对多还是多对多的关系
  - 一对一，两实体有自己的主键，同时也都各有对应实体的主键字段
  - 一对多，多的一方存储一这方的主键字段
  - 多对多，单独增加一个关系的表，存储两个表中的主键字段，可以看作是两个一对多的关系



## 四、数据库范式

- 1NF范式，属性要求不可分。例如：女教师，应当可以拆分为两个字段，性别：女；职业：教师。
- 2NF范式，无部分依赖。所谓部分依赖，就是表中的某些字段只依赖于主属性中的部分，而不是所有的主属性，在2NF下，需要保证表中属性是完全依赖的。
- 3NF范式，无传递依赖。所谓的传递依赖，就是存在某属性依赖的是表中的非主属性，如学生->专业->学院，这里学院依赖的是专业。



## 五、索引的数据结构

### 1. B+树索引

- B+树也是一种平衡二叉树，所有的元素都在同一层叶子结点，支持顺序查找，按大小顺序存储。

### 2. Hash索引

- 时间复杂度为O(1)，因为是按照哈希函数输出位置，所以无法进行分区查找。

