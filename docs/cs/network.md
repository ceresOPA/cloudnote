# 计算机网络

> 对常用与遗忘知识点进行总结与复习
>
> 参考资料：程序员宝藏(微信公众号)

## 一、基础概念篇

### 1) 概述

#### OSI模型与TCP/IP模型

| 模型               | 分层                                                       |
| ------------------ | ---------------------------------------------------------- |
| OSI模型（七层）    | 物理层、数据链路层、网络层、传输层、会话层、表示层、应用层 |
| TCP/IP模型（四层） | 网络接口层、网际层、运输层、应用层                         |



## 二、面试/复试篇

### 1) TCP/IP相关问题

#### 1. Q：TCP是如何保证数据的可靠、有序、不丢失的？

- 答：TCP报文段通过**校验、序号、确认、重传**等机制来保证数据传输的**可靠、有序与不丢失**。

#### 2. Q：为什么TCP通信的双方都需要设置缓存？

- 答：TCP通信是全双工方式，双方都可以同时发送数据，<font color="red">**因此需要缓存来临时存放双向通信的数据**</font>。
  - 发送缓存：1.  未发送出去的数据；2. 已发送但未收到确认的数据
  - 接收缓存：1.未按序到达的数据； 2. 已按序接收未被读取的数据

#### 3. Q：分别说一下ACK、SYN和FIN标志位

- ACK确认位，ACK=1时有效，在连接建立后的数据传输中，ACK都应设置为1
- SYN连接请求位，用于连接的请求或连接建立的确认
- FIN连接释放位，当发送一个FIN报文段后，表明FIN报文段的发送方的**数据已发送完毕，并要释放传输连接**

#### 4. Q：什么是SYN泛洪攻击？

- 答：在TCP的三次握手建立连接的过程中，**服务端的资源分配发生在第二次握手**。若出现客户端发送第一次请求连接，服务端向客户端发送连接并确认的报文段后，客户端却不再进行确认，此时这种状态称之为**TCP的半连接**。当被恶意造成大量这种TCP半连接的状态时，服务器会因为一直白白浪费大量资源，出现无法为正常用户提供服务，甚至可能会出现死机的情况。

#### 5. Q：如果已经建立了连接，但是客户端出现了故障怎么办？

- 答：TCP设置有保活计时器，通常为2个小时，当客户端在2小时内再次发送请求后，会将保活计时器进行重置。若2个小时都没有收到客户端的请求，则服务端会发送一个探测报文段，每隔75秒发送一次，当连续10次发送后都没有任何反应，则认为客户端已发生故障，断开连接。

#### 6. Q：为什么不采用“两次握手”建立连接？

- 答：两次握手建立连接存在<font color="red">**已失效的连接请求报文段发送到服务端**</font>的问题，具体来说就是，假设客户端发送了一次请求连接的报文后，但由于网络问题，导致还没发送到服务端，此时客户端又重新发送了一次请求连接的报文，并成功与服务端建立连接，最后完成释放连接。然而在完成释放连接后，客户端第一次发送的请求连接报文段又到达服务端，因为此时是两次握手，因此服务端发送一个确认报文后就认为连接已经建立了，但是这个时候客户端并不会去发送请求，导致资源白白浪费。

  ?> 上面的答案是看了两份网上的解释得到的，第一次看这个的时候，总感觉不是原因，因为自己一开始理解的是 如果没有第三次的握手，那么服务端不就不知道自己发送出去的报文有没有被正确接收吗？同时，如果只到第二次握手为止，那么接收方能够正常接收报文也无法进行确定。 这只是单纯自己的一个理解，网上也有类似想法的，说有很多种解释，就先留在这里供以后参考吧。

#### 7. Q：为什么连接的时候是三次握手，而释放的时候是四次挥手？

- 答：因为连接的时候第一次握手，客户端发送SYN=1的请求连接报文后，服务端直接发送一个SYN=1和ACK=1的确认报文，即此时的连接建立和确认是同时发送的；而在释放的过程中，客户端发送FIN连接释放报文后，服务端由于可能还存在需要发送的数据，所以并不会马上发送一个FIN报文，而是会先发送一个确认报文，表示自己已经收到了，然后当自己的数据全部发送完毕后再发送FIN报文，因此连接的时候是三次，而释放的时候需要四次才能完成。

#### 8. 为什么TIME_WAIT要经过2MSL(最大报文生存时间)才会返回到CLOSED状态？

- 答：因此在客户端发送最后的确认报文后，有可能存在服务端没有收到该报文的情况，因此客户端需要等待2MSL，若确认报文丢失或超时，则在这段时间内会重新发送，并再等待2MSL，若在接下来的2MSL中未出现丢失或超时的情况，则客户端认为服务端已成功收到了该确认报文，从而进入CLOSED状态。

## 2) 介质访问控制协议

### 1. Q：什么是介质访问控制协议？为什么要使用介质访问控制协议？

- 答：介质访问控制协议是数据链路层的协议，由于在局域网下，是采用广播的方式进行通信，这就意味着在局域网内的所有主机都能够收到数据帧，从而导致数据通信中会出现不同主机间通信受到干扰，发生数据帧碰撞的问题。因此，**需要通过介质访问控制协议有效地分配传输介质的使用权**。



